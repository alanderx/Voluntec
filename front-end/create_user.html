<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cadastro - Voluntec</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f8f9fa;
      padding: 2rem 0;
    }
    .form-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 2rem;
      border-radius: 8px;
      border: 1px solid #dee2e6;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="form-container">
      <h2 class="mb-4 text-center">Cadastro de Usuário</h2>
      
      <div id="alertMessage"></div>
      
      <form id="createUserForm">
        <div class="mb-3">
          <label for="name" class="form-label">Nome Completo</label>
          <input type="text" class="form-control" id="name" name="name" required>
        </div>
        
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>
        
        <div class="mb-3">
          <label for="password" class="form-label">Senha</label>
          <input type="password" class="form-control" id="password" name="password" required>
        </div>
        
        <div class="mb-3">
          <label for="birth_date" class="form-label">Data de Nascimento</label>
          <input type="date" class="form-control" id="birth_date" name="birth_date" required>
        </div>
        
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="city" class="form-label">Cidade</label>
            <input type="text" class="form-control" id="city" name="city" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="state" class="form-label">Estado</label>
            <select class="form-select" id="state" name="state" required>
              <option value="">Selecione...</option>
              <option value="AC">AC</option>
              <option value="AL">AL</option>
              <option value="AP">AP</option>
              <option value="AM">AM</option>
              <option value="BA">BA</option>
              <option value="CE">CE</option>
              <option value="DF">DF</option>
              <option value="ES">ES</option>
              <option value="GO">GO</option>
              <option value="MA">MA</option>
              <option value="MT">MT</option>
              <option value="MS">MS</option>
              <option value="MG">MG</option>
              <option value="PA">PA</option>
              <option value="PB">PB</option>
              <option value="PR">PR</option>
              <option value="PE">PE</option>
              <option value="PI">PI</option>
              <option value="RJ">RJ</option>
              <option value="RN">RN</option>
              <option value="RS">RS</option>
              <option value="RO">RO</option>
              <option value="RR">RR</option>
              <option value="SC">SC</option>
              <option value="SP">SP</option>
              <option value="SE">SE</option>
              <option value="TO">TO</option>
            </select>
          </div>
        </div>
        
        <div class="mb-3">
          <label for="country" class="form-label">País</label>
          <input type="text" class="form-control" id="country" name="country" value="Brazil" required>
        </div>
        
        <button type="submit" class="btn btn-primary w-100">Continuar</button>
      </form>
      
      <div class="text-center mt-3">
        <p class="mb-0">Já tem conta? <a href="login.html">Fazer login</a></p>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('createUserForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = new FormData();
      formData.append('name', document.getElementById('name').value);
      formData.append('email', document.getElementById('email').value);
      formData.append('password', document.getElementById('password').value);
      formData.append('birth_date', document.getElementById('birth_date').value);
      formData.append('city', document.getElementById('city').value);
      formData.append('state', document.getElementById('state').value);
      formData.append('country', document.getElementById('country').value);
      
      try {
        const response = await fetch('/Voluntec/app/user/create_user.php', {
          method: 'POST',
          body: formData
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.codigo) {
          // Store user ID and email for next steps
          sessionStorage.setItem('temp_user_id', data.id);
          sessionStorage.setItem('temp_user_email', document.getElementById('email').value);
          sessionStorage.setItem('temp_user_password', document.getElementById('password').value);
          
          alert('Cadastro realizado com sucesso!');
          window.location.href = 'areas_of_interest.html';
        } else {
          document.getElementById('alertMessage').innerHTML = 
            '<div class="alert alert-danger">' + data.msg + '</div>';
        }
      } catch (error) {
        console.error('Erro:', error);
        alert('Erro ao cadastrar: ' + error.message);
      }
    });
  </script>
</body>
</html>

